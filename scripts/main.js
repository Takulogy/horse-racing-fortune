// é¦¬åãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆå ã„ç”¨ã®ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼é¦¬åï¼‰
const horseNames = [
    "ã‚µãƒ³ãƒ€ãƒ¼ãƒœãƒ«ãƒˆ", "ã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ã‚¦ã‚£ãƒ³ã‚°", "ãƒ•ã‚¡ã‚¤ã‚¢ãƒ¼ã‚¹ãƒˆãƒ¼ãƒ ", "ã‚¹ãƒ”ãƒ¼ãƒ‰ã‚¹ã‚¿ãƒ¼",
    "ãƒŸãƒ©ã‚¯ãƒ«ãƒ©ãƒ³ãƒŠãƒ¼", "ãƒ–ãƒ©ãƒƒã‚¯ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰", "ã‚·ãƒ«ãƒãƒ¼ã‚¢ãƒ­ãƒ¼", "ã‚¯ãƒªãƒ ã‚¾ãƒ³ãƒ•ãƒ¬ãƒ¼ãƒ ",
    "ã‚¨ãƒ¡ãƒ©ãƒ«ãƒ‰ã‚­ãƒ³ã‚°", "ã‚µãƒ•ã‚¡ã‚¤ã‚¢ãƒ—ãƒªãƒ³ã‚¹", "ãƒ«ãƒ“ãƒ¼ã‚¨ãƒ³ã‚¸ã‚§ãƒ«", "ã‚¢ãƒ¡ã‚¸ã‚¹ãƒˆã‚¯ã‚¤ãƒ¼ãƒ³",
    "ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ãƒ•ãƒ©ãƒƒã‚·ãƒ¥", "ãƒ—ãƒ©ãƒãƒŠãƒ ãƒ¬ã‚¤ãƒ³", "ã‚´ãƒ¼ãƒ«ãƒ‰ãƒ©ãƒƒã‚·ãƒ¥", "ã‚¹ã‚¿ãƒ¼ãƒ©ã‚¤ãƒˆ",
    "ãƒ ãƒ¼ãƒ³ãƒ“ãƒ¼ãƒ ", "ã‚µãƒ³ãƒ©ã‚¤ã‚º"
];

// å®Ÿéš›ã®ãƒ¬ãƒ¼ã‚¹å‡ºèµ°é¦¬ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
const raceHorses = {
    'takarazuka': [
        'ãƒ¬ã‚¬ãƒ¬ã‚¤ãƒ©', 'ãƒ™ãƒ©ã‚¸ã‚ªã‚ªãƒšãƒ©', 'ã‚¢ãƒ¼ãƒãƒ³ã‚·ãƒƒã‚¯', 'ãƒ¨ãƒ¼ãƒ›ãƒ¼ãƒ¬ã‚¤ã‚¯', 
        'ãƒ¡ã‚¤ã‚·ãƒ§ã‚¦ã‚¿ãƒãƒ«', 'ãƒªãƒ“ã‚¢ãƒ³ã‚°ãƒ©ã‚¹', 'ãƒ­ãƒ¼ãƒ‰ãƒ‡ãƒ«ãƒ¬ã‚¤', 'ã‚·ãƒ§ã‚¦ãƒŠãƒ³ãƒ©ãƒ—ãƒ³ã‚¿',
        'ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒªãƒ’ãƒˆ', 'ã‚µãƒ³ãƒ©ã‚¤ã‚ºãƒ•ãƒ©ã‚°', 'ã‚½ãƒ¼ãƒ«ã‚ªãƒªã‚¨ãƒ³ã‚¹',
        'ãƒ‰ã‚¥ãƒ¬ãƒƒãƒ„ã‚¢', 'ãƒ—ãƒ©ã‚¤ãƒ‰ãƒ©ãƒ³ãƒ‰', 'ã‚¨ãƒ¼ãƒ‡ãƒ«ãƒ¯ã‚¤ã‚¼', 'ã‚°ãƒ©ãƒ³ãƒ‡ã‚µãƒ ãƒ©ã‚¤',
        'ãƒ—ãƒ©ãƒ€ãƒªã‚¢', 'ã‚¹ãƒ†ãƒ©ãƒ–ãƒ«ãƒ¼', 'ã‚­ãƒ³ã‚°ã‚ªãƒ–ã‚³ãƒ¼ã‚¸'
    ],
    'yasuda': [
        'ã‚¸ãƒ£ãƒ³ã‚¿ãƒ«ãƒãƒ³ã‚¿ãƒ«', 'ã‚¬ã‚¤ã‚¢ãƒ•ã‚©ãƒ¼ã‚¹', 'ã‚½ã‚¦ãƒ«ãƒ©ãƒƒã‚·ãƒ¥', 'ãƒ–ãƒ¬ã‚¤ãƒ‡ã‚£ãƒ´ã‚§ãƒ¼ã‚°',
        'ã‚·ãƒƒã‚¯ã‚¹ãƒšãƒ³ã‚¹', 'ã‚¸ãƒ¥ãƒ³ãƒ–ãƒ­ãƒƒã‚µãƒ ', 'ãƒãƒƒãƒ‰ã‚¯ãƒ¼ãƒ«', 'ã‚¦ã‚¤ãƒ³ãƒãƒ¼ãƒ™ãƒ«',
        'ãƒˆãƒ­ãƒ´ã‚¡ãƒˆãƒ¼ãƒ¬', 'ã‚·ãƒ£ãƒ³ãƒ‘ãƒ³ã‚«ãƒ©ãƒ¼', 'ã‚¨ã‚³ãƒ­ãƒ´ã‚¡ãƒ«ãƒ„', 'ãƒ—ãƒªãƒ†ã‚£ã‚¢ãƒ³ã‚¸ã‚§ãƒ«',
        'ãƒ´ã‚§ãƒ­ãƒ¼ãƒŠã‚·ãƒãƒ¼', 'ã‚¹ãƒ¬ãƒ¼ãƒˆãƒ‡ã‚¸ã‚¿ãƒ«', 'ãƒã‚¤ã‚ªã‚¹ãƒ•ã‚£ã‚¢', 'ãƒŠãƒ ãƒ©ã‚¯ãƒ¬ã‚¢',
        'ãƒ¢ãƒ¼ãƒ‰ãƒ–ãƒªãƒ¼ã‚º', 'ãƒ¬ã‚¸ãƒ¼ãƒŠãƒ¡ãƒƒã‚»'
    ],
    'derby': [
        'ã‚¯ãƒ­ãƒ¯ãƒ‡ãƒ¥ãƒãƒ¼ãƒ«', 'ã‚¢ãƒªã‚¹ãƒˆãƒ†ãƒ¬ã‚¹', 'ã‚·ãƒ§ã‚¦ãƒŠãƒ³ãƒãƒƒã‚­ãƒ¼', 'ãƒ¬ã‚¾ãƒŠãƒ³ã‚¹',
        'ãƒ¯ãƒ¼ãƒ«ãƒ‰ãƒªãƒãƒ¼', 'ã‚·ãƒ³ã‚¨ãƒ³ãƒšãƒ©ãƒ¼', 'ãƒ›ã‚¦ã‚ªã‚¦ã‚¬ã‚¤ã‚¢', 'ã‚¢ãƒ‰ãƒã‚¤ãƒ¤ãƒ™ãƒ«ã‚¯',
        'ã‚¹ãƒ†ãƒ©ãƒªã‚¢', 'ã‚µãƒ¼ãƒãƒ«ã‚¨ãƒŠã‚¸ãƒ¼', 'ãƒ–ãƒ«ãƒ¼ãƒŸãƒ³ã‚°ã‚¹ã‚«ã‚¤', 'ãƒ•ãƒ­ãƒ³ãƒ†ã‚£ã‚¢',
        'ãƒ€ãƒ³ãƒ„ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰', 'ã‚µãƒ©ãƒ–ãƒ¬ãƒ‰ãƒ‘ã‚¤', 'ãƒšã‚¬ã‚µã‚¹ãƒ†ãƒ¼ãƒ«', 'ã‚·ãƒ«ãƒãƒ¼ã‚¦ã‚£ãƒ³ã‚°ã‚¹',
        'ã‚³ã‚¹ãƒ¢ãƒ†ã‚£ã‚¢ãƒ©', 'ãƒ¬ãƒ‡ã‚£ãƒ¼ãƒ­ãƒ¼ã‚º'
    ],
    'oaks': [
        'ãƒ©ã‚¤ãƒˆãƒãƒƒã‚¯', 'ã‚¯ãƒ¬ãƒ ã‚¹ãƒ‡ã‚£ã‚ª', 'ãƒ¬ã‚¬ãƒ¬ã‚¤ãƒ©', 'ãƒãƒ¼ãƒ™ãƒ«ã‚¹ãƒã‚¤ãƒ«',
        'ã‚ªãƒ¼ã‚¯ã‚·ãƒ§ãƒ³ãƒã‚¦ã‚¹', 'ãƒ€ã‚¹ãƒˆãƒ‡ãƒ“ãƒ«', 'ãƒãƒªã‚½ãƒ¼ãƒ—', 'ã‚¢ã‚ºã‚µãƒ³',
        'ã‚·ãƒ¼ãƒ‹ãƒƒã‚¯ã‚¬ãƒ¼ãƒ‡ãƒ³', 'ã‚¯ãƒ©ã‚¤ãƒãƒƒã‚¯ã‚¹ãƒ‡ãƒ¼', 'ã‚¢ãƒ¼ãƒˆã‚²ãƒ«', 'ã‚³ã‚¹ãƒ¢ãƒ–ãƒ«ãƒ¼',
        'ãƒã‚¤ãƒ˜ãƒƒãƒ‰', 'ãƒ€ãƒ¼ã‚¯ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼', 'ã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ã‚¦ã‚£ãƒ³ã‚°', 'ã‚¹ã‚¿ãƒ¼ãƒ©ã‚¤ãƒˆ',
        'ã‚¢ãƒ™ãƒ‹ãƒ¥ãƒ¼ã‚¢ãƒ¼ãƒˆ', 'ãƒ©ãƒ–ãƒªãƒ¼ãƒ—ãƒªãƒ³ã‚»ã‚¹'
    ],
    'victoria': [
        'ãƒ¬ã‚¬ãƒ¬ã‚¤ãƒ©', 'ãƒ–ãƒ¬ã‚¤ãƒ‡ã‚£ãƒ´ã‚§ãƒ¼ã‚°', 'ã‚·ãƒƒã‚¯ã‚¹ãƒšãƒ³ã‚¹', 'ã‚¢ã‚«ã‚¤ãƒˆãƒªãƒãƒ ã‚¹ãƒ¡',
        'ãƒªãƒãƒ†ã‚£ã‚¢ã‚¤ãƒ©ãƒ³ãƒ‰', 'ã‚µãƒ³ã‚¯ãƒ†ãƒ¥ã‚¨ãƒ¼ãƒ«', 'ã‚½ãƒ¼ãƒ´ã‚¡ãƒªã‚¢ãƒ³ãƒˆ', 'ãƒ¢ãƒ¼ãƒªã‚¹',
        'ãƒŠã‚¹ãƒãƒ¦ãƒ¡', 'ãƒªãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°', 'ã‚¹ãƒˆãƒ¼ãƒŸãƒ¼ã‚·ãƒ¼', 'ã‚¢ãƒ«ã‚¢ã‚¤ãƒ³',
        'ã‚¹ã‚«ãƒ¼ãƒ¬ãƒƒãƒˆã‚«ãƒ©ãƒ¼', 'ãƒ¡ã‚¤ã‚±ã‚¤ã‚¨ãƒ¼ãƒ«', 'ãƒ—ãƒªãƒ†ã‚£ã‚¢ãƒ³ã‚¸ã‚§ãƒ«', 'ãƒªã‚ªãƒ³ãƒªã‚ªãƒ³',
        'ãƒ´ã‚§ãƒ­ãƒ‹ã‚«', 'ã‚·ãƒ«ãƒ“ã‚¢ãƒ³'
    ],
    'tennosho_spring': [
        'ãƒ¬ã‚¬ãƒ¬ã‚¤ãƒ©', 'ã‚·ãƒ§ã‚¦ãƒŠãƒ³ãƒ©ãƒ—ãƒ³ã‚¿', 'ãƒ´ã‚§ãƒ­ãƒ¼ãƒŠã‚·ãƒãƒ¼', 'ã‚¿ã‚¤ãƒˆãƒ«ãƒ›ãƒ«ãƒ€ãƒ¼',
        'ã‚¹ãƒ¬ãƒ¼ãƒˆãƒ‡ã‚¸ã‚¿ãƒ«', 'ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒªãƒ’ãƒˆ', 'ã‚¢ãƒ´ã‚¡ãƒ³ã‚»', 'ã‚­ãƒ³ã‚°ã‚¹ã‚ªãƒ¼ãƒ€ãƒ¼',
        'ãƒ†ãƒ³ãƒã‚¤ãƒ³ãƒˆ', 'ã‚´ãƒ¼ãƒ«ãƒ‰ã‚¢ã‚¯ã‚¿ãƒ¼', 'ã‚¦ã‚·ãƒ¥ãƒãƒ†ã‚½ãƒ¼ãƒ­', 'ãƒ‰ã‚¥ãƒ¬ãƒƒãƒ„ã‚¢',
        'ãƒ¯ãƒ¼ãƒ«ãƒ‰ãƒ—ãƒ¬ãƒŸã‚¢', 'ãƒ–ãƒ©ã‚¹ãƒˆãƒ¯ãƒ³ãƒ”ãƒ¼ã‚¹', 'ã‚½ãƒ¼ãƒ«ã‚ªãƒªã‚¨ãƒ³ã‚¹', 'ã‚¨ãƒ¼ãƒ‡ãƒ«ãƒ¯ã‚¤ã‚¼',
        'ã‚·ãƒ¥ãƒ«ãƒ´ã‚£ãƒ³', 'ã‚¹ãƒšã‚¯ã‚¿ã‚¯ãƒ«'
    ],
    'oka_sho': [
        'ãƒ©ã‚¤ãƒˆãƒãƒƒã‚¯', 'ãƒ¬ã‚¬ãƒ¬ã‚¤ãƒ©', 'ã‚¯ãƒ¬ãƒ ã‚¹ãƒ‡ã‚£ã‚ª', 'ãƒ©ã‚¤ãƒ•ãƒãƒ³ã‚¯ãƒ¼',
        'ãƒˆã‚¥ãƒ‰ã‚¢ãƒ—ãƒ©ã‚¤ãƒ ', 'ã‚½ãƒ•ã‚£ã‚¢ãƒ©ã‚¤ãƒ–', 'ãƒ‹ãƒ¥ãƒ¼ãƒ¢ãƒ‡ãƒ«', 'ã‚´ãƒ¼ãƒ«ãƒ‰ãƒãƒ³ã‚¿ãƒ¼',
        'ãƒ‹ã‚·ãƒã‚³ãƒ³ã‚­ã‚¹ã‚¿', 'ãƒãƒ¼ãƒ™ãƒ«ã‚¹ãƒã‚¤ãƒ«', 'ã‚¨ãƒ ãƒ†ã‚£ãƒ¼ãƒ“ãƒ¼', 'ãƒªãƒªã‚«ãƒ«ãƒ›ãƒ¯ã‚¤ãƒˆ',
        'ã‚µã‚¯ãƒ©ãƒ—ãƒ­ãƒŸã‚¹', 'ãƒ“ã‚¢ãƒ³ã‚«', 'ãƒ”ãƒ³ã‚¯ã‚«ãƒ¡ãƒãƒ¡ãƒ', 'ã‚½ãƒªã‚¿ãƒªãƒ¼',
        'ã‚°ãƒ©ãƒ³ãƒ‰ã‚¹ãƒ©ãƒ ', 'ãƒ¬ãƒ‡ã‚£ãƒ¼ãƒ•ãƒ¬ã‚¤'
    ],
    'satsuki_sho': [
        'ã‚¢ãƒªã‚¹ãƒˆãƒ†ãƒ¬ã‚¹', 'ã‚·ãƒ§ã‚¦ãƒŠãƒ³ãƒãƒƒã‚­ãƒ¼', 'ãƒ¬ã‚¾ãƒŠãƒ³ã‚¹', 'ã‚·ãƒ³ã‚¨ãƒ³ãƒšãƒ©ãƒ¼',
        'ã‚¢ãƒ‰ãƒã‚¤ãƒ¤ãƒ™ãƒ«ã‚¯', 'ãƒ–ãƒ«ãƒ¼ãƒŸãƒ³ã‚°ã‚¹ã‚«ã‚¤', 'ãƒ€ãƒ³ãƒ„ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰', 'ã‚¢ã‚¹ã‚¯ãƒ‰ãƒªãƒ¼ãƒ ã‚¹',
        'ã‚³ã‚ºãƒŸãƒƒã‚¯ãƒ•ã‚©ãƒ¼ã‚¹', 'ãƒ›ã‚¦ã‚ªã‚¦ã‚¬ã‚¤ã‚¢', 'ãƒ•ãƒ­ãƒ³ãƒ†ã‚£ã‚¢', 'ã‚µãƒ¼ãƒãƒ«ã‚¨ãƒŠã‚¸ãƒ¼',
        'ãƒšã‚¬ã‚µã‚¹ãƒ†ãƒ¼ãƒ«', 'ãƒˆãƒ¼ã‚»ãƒ³ã‚¢ãƒ©ãƒ³', 'ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒ•ã‚§ãƒ‹ãƒƒã‚¯ã‚¹', 'ã‚¨ã‚¢ãƒ•ã‚©ãƒ¼ã‚¹',
        'ã‚·ãƒ«ãƒãƒ¼ã‚¦ã‚£ãƒ³ã‚°ã‚¹', 'ãƒ­ãƒ¼ãƒ‰ã‚¹ãƒˆãƒ¼ãƒ '
    ]
};

// å ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆå¯¾è±¡ãƒ¬ãƒ¼ã‚¹åˆ¥ï¼‰
const raceSpecificMessages = {
    'takarazuka': [
        "å®å¡šè¨˜å¿µã¯ä¸ŠåŠæœŸã®é ‚ç‚¹ã‚’æ±ºã‚ã‚‹ä¸€æˆ¦ï¼ã“ã®é¦¬ãŒã‚ãªãŸã«æ „å…‰ã‚’ã‚‚ãŸã‚‰ã—ã¾ã™ã€‚",
        "é˜ªç¥ç«¶é¦¬å ´ã®å‚ã‚’åˆ¶ã™ã‚‹ã®ã¯ã“ã®é¦¬ã§ã™ã€‚ã‚ãªãŸã®å¿œæ´ãŒå‹åˆ©ã¸ã®éµã¨ãªã‚‹ã§ã—ã‚‡ã†ã€‚",
        "ãƒ•ã‚¡ãƒ³æŠ•ç¥¨ã®å®å¡šè¨˜å¿µã€ã‚ãªãŸã®å¿ƒãŒé¸ã‚“ã ã“ã®é¦¬ãŒå¥‡è·¡ã‚’èµ·ã“ã—ã¾ã™ã€‚"
    ],
    'yasuda': [
        "å®‰ç”°è¨˜å¿µã¯ãƒã‚¤ãƒ«ç‹æ±ºå®šæˆ¦ï¼ã“ã®é¦¬ãŒã‚ãªãŸã«é€Ÿã•ã¨èˆˆå¥®ã‚’å±Šã‘ã¦ãã‚Œã¾ã—ãŸã€‚",
        "æ±äº¬1600mã‚’åˆ¶ã—ãŸã“ã®é¦¬ã€ã‚ãªãŸã®ç›´æ„ŸåŠ›ã®è¨¼æ˜ã§ã™ã€‚",
        "ã‚¹ãƒ”ãƒ¼ãƒ‰ã®ç¥­å…¸ã§é¸ã°ã‚Œã—ã“ã®é¦¬ã€ç´ æ™´ã‚‰ã—ã„çµæœã ã£ãŸã¯ãšã§ã™ã€‚"
    ],
    'derby': [
        "æ—¥æœ¬ãƒ€ãƒ¼ãƒ“ãƒ¼ã¯3æ­³é¦¬ã®æœ€é«˜å³°ï¼ã“ã®é¦¬ãŒã‚ãªãŸã«ã‚¯ãƒ©ã‚·ãƒƒã‚¯ã®æ„Ÿå‹•ã‚’ã‚‚ãŸã‚‰ã—ã¾ã—ãŸã€‚",
        "åºœä¸­ã®ç›´ç·šã‚’é§†ã‘æŠœã‘ãŸã“ã®é¦¬ã€ã‚ãªãŸã®é’æ˜¥ã®1ãƒšãƒ¼ã‚¸ã‚’é£¾ã£ãŸã¯ãšã§ã™ã€‚",
        "ãƒ€ãƒ¼ãƒ“ãƒ¼é¦¬ã¯ãƒ’ãƒ¼ãƒ­ãƒ¼ï¼ã“ã®é¦¬ãŒã‚ãªãŸã«æ°¸é ã®æ€ã„å‡ºã‚’æ®‹ã—ã¦ãã‚Œã¾ã—ãŸã€‚"
    ]
};

const defaultMessages = [
    "ä»Šæ—¥ã®ã‚ãªãŸã«ã¯å‹åˆ©ã®é¢¨ãŒå¹ã„ã¦ã„ã¾ã™ã€‚ã“ã®é¦¬ãŒã‚ãªãŸã«å¹¸é‹ã‚’ã‚‚ãŸã‚‰ã™ã§ã—ã‚‡ã†ã€‚",
    "æ˜Ÿã®é…ç½®ãŒã‚ãªãŸã¨ã“ã®é¦¬ã®çµ†ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚ä¿¡ã˜ã¦å¿œæ´ã—ã¾ã—ã‚‡ã†ã€‚",
    "ã‚ãªãŸã®ç›´æ„ŸåŠ›ãŒæœ€é«˜æ½®ã«é”ã—ã¦ã„ã¾ã™ã€‚ã“ã®é¦¬ãŒå¥‡è·¡ã‚’èµ·ã“ã™ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚",
    "é‹å‘½ã®æ­¯è»ŠãŒå‹•ãå§‹ã‚ã¾ã—ãŸã€‚ã“ã®é¦¬ãŒã‚ãªãŸã®æœŸå¾…ã«å¿œãˆã¦ãã‚Œã‚‹ã¯ãšã§ã™ã€‚"
];

// ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š
document.addEventListener('DOMContentLoaded', function() {
    document.getElementById('fortuneForm').addEventListener('submit', function(e) {
        e.preventDefault();
        e.stopPropagation();
        startFortune();
        return false;
    });
});

function startFortune() {
    const zodiac = document.getElementById('zodiac').value;
    const bloodType = document.getElementById('bloodType').value;
    const targetRace = document.getElementById('targetRace').value;
    const luckyNumber = parseInt(document.getElementById('luckyNumber').value);

    if (!zodiac || !bloodType || !targetRace || !luckyNumber) {
        alert('ã™ã¹ã¦ã®é …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚');
        return;
    }

    // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
    document.getElementById('loading').style.display = 'block';
    document.getElementById('result').style.display = 'none';
    document.querySelector('.fortune-btn').disabled = true;

    // å ã„è¨ˆç®—ï¼ˆ2ç§’å¾Œã«çµæœè¡¨ç¤ºï¼‰
    setTimeout(() => {
        const result = calculateFortune(zodiac, bloodType, targetRace, luckyNumber);
        displayResult(result);
    }, 2000);
}

function calculateFortune(zodiac, bloodType, targetRace, luckyNumber) {
    // å ã„ãƒ­ã‚¸ãƒƒã‚¯
    let seed = 0;
    
    // æ˜Ÿåº§ã«ã‚ˆã‚‹åŸºæœ¬æ•°å€¤
    const zodiacValues = {
        'aries': 1, 'taurus': 2, 'gemini': 3, 'cancer': 4,
        'leo': 5, 'virgo': 6, 'libra': 7, 'scorpio': 8,
        'sagittarius': 9, 'capricorn': 10, 'aquarius': 11, 'pisces': 12
    };
    
    // è¡€æ¶²å‹ã«ã‚ˆã‚‹ä¿‚æ•°
    const bloodTypeValues = {
        'A': 3, 'B': 7, 'O': 11, 'AB': 13
    };

    // å¯¾è±¡ãƒ¬ãƒ¼ã‚¹ã«ã‚ˆã‚‹è£œæ­£å€¤
    const raceValues = {
        'takarazuka': 5, 'yasuda': 8, 'derby': 12, 'oaks': 9,
        'victoria': 6, 'tennosho_spring': 15, 'oka_sho': 4, 'satsuki_sho': 7
    };

    seed = (zodiacValues[zodiac] * bloodTypeValues[bloodType] + raceValues[targetRace] + luckyNumber) % 18 + 1;
    
    const horseNumber = seed;
    const horseName = horseNames[seed - 1];
    
    // å®Ÿéš›ã®ãƒ¬ãƒ¼ã‚¹é¦¬ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã§é¸æŠ
    const actualRaceHorses = raceHorses[targetRace] || [];
    const actualHorse = actualRaceHorses.length > 0 ? 
        actualRaceHorses[Math.floor(Math.random() * actualRaceHorses.length)] : null;
    
    // å¯¾è±¡ãƒ¬ãƒ¼ã‚¹åˆ¥ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å–å¾—
    const messages = raceSpecificMessages[targetRace] || defaultMessages;
    const message = messages[Math.floor(Math.random() * messages.length)];

    return {
        number: horseNumber,
        name: horseName,
        message: message,
        race: targetRace,
        actualHorse: actualHorse
    };
}

function displayResult(result) {
    document.getElementById('loading').style.display = 'none';
    
    document.getElementById('horseNumber').textContent = `${result.number}ç•ª`;
    document.getElementById('horseName').textContent = result.name;
    document.getElementById('fortuneMessage').textContent = result.message;
    
    // å®Ÿéš›ã®ãƒ¬ãƒ¼ã‚¹é¦¬ã‚’è¡¨ç¤ºã™ã‚‹éƒ¨åˆ†
    const actualHorseContainer = document.getElementById('actualHorseContainer');
    actualHorseContainer.innerHTML = ''; // ã‚¯ãƒªã‚¢
    
    if (result.actualHorse) {
        const actualHorseCard = document.createElement('div');
        actualHorseCard.className = 'actual-horse-card';
        
        actualHorseCard.innerHTML = `
            <div class="actual-horse-title">
                ğŸ å®Ÿéš›ã®ãƒ¬ãƒ¼ã‚¹å‡ºèµ°é¦¬
            </div>
            <div class="actual-horse-name">
                ${result.actualHorse}
            </div>
            <div class="actual-horse-message">
                é¸æŠã•ã‚ŒãŸãƒ¬ãƒ¼ã‚¹ã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã§é¸ã°ã‚ŒãŸå®Ÿéš›ã®å‡ºèµ°é¦¬ã§ã™
            </div>
        `;
        
        actualHorseContainer.appendChild(actualHorseCard);
    }
    
    document.getElementById('result').style.display = 'block';
    document.querySelector('.fortune-btn').disabled = false;
    
    // çµæœã¾ã§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
    document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
}

function resetForm() {
    document.getElementById('fortuneForm').reset();
    document.getElementById('result').style.display = 'none';
    document.getElementById('loading').style.display = 'none';
    document.querySelector('.fortune-btn').disabled = false;
    document.getElementById('actualHorseContainer').innerHTML = '';
}